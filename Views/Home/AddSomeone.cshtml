@model GCTConnect.Models.User



<h1>Add Someone</h1>

<div>
    <form asp-action="AddSomeone" asp-controller="Home" method="post">
        <div class="form-group">
            <label asp-for="Name">First Name</label>
            <input asp-for="Name" class="form-control" placeholder="Enter first name" />
            <span asp-validation-for="Name" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="LastName">Last Name</label>
            <input asp-for="LastName" class="form-control" placeholder="Enter last name" />
            <span asp-validation-for="LastName" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="Email">Email Address</label>
            <input asp-for="Email" class="form-control" placeholder="Enter email" />
            <span asp-validation-for="Email" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="PhoneNumber">Phone Number</label>
            <input asp-for="PhoneNumber" class="form-control" placeholder="Enter phone number" />
            <span asp-validation-for="PhoneNumber" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="Gender">Gender</label>
            <select asp-for="Gender" class="form-control">
                <option value="">Select Gender</option>
                <option value="Male">Male</option>
                <option value="Female">Female</option>
                <option value="Other">Other</option>
            </select>
            <span asp-validation-for="Gender" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="Role">Role</label>
            <div id="roleOptionsForAdmin" style="display:none">
                <select asp-for="Role" class="form-control" id="roleOptionsForAdminSelect">
                    <option value="">Select Role</option>
                    <option value="Students">Student</option>
                    <option value="Teachers">Teacher</option>
                    <option value="Hod">Hod</option>
                    <option value="Principal">Principal</option>
                    <option value="Admin">Admin</option>
                </select>
            </div>

            <div id="roleOptionsForHod" style="display:none">
                <select asp-for="Role" class="form-control" id="roleOptionsForHodSelect">
                    <option value="">Select Role</option>
                    <option value="Students">Student</option>
                    <option value="Teachers">Teacher</option>
                </select>
            </div>
            <span asp-validation-for="Role" class="text-danger"></span>
        </div>

        <div class="form-group" id="department" style="display:none">
            <label asp-for="DepartmentId">Department Name</label>
            <select asp-for="DepartmentId" asp-items="@(new SelectList(ViewBag.Departments, "Id", "Name"))" class="form-control">
                <option value="">Select Department</option>
            </select>
            <span asp-validation-for="DepartmentId" class="text-danger"></span>
        </div>


        <div class="form-group" id="rollno" style="display:none">
            <label asp-for="RollNumber">Roll Number (for Students only)</label>
            <input asp-for="RollNumber" class="form-control" placeholder="Enter roll number" />
            <span asp-validation-for="RollNumber" class="text-danger"></span>
        </div>

        <div class="form-group" id="batch" style="display:none">
            <label asp-for="BatchId">Batch Year (for Students only)</label>
            <select asp-for="BatchId"
                    asp-items="@(new SelectList(ViewBag.Batches, "Id", "Year"))"
                    class="form-control">
                <option value="">Select Batch Year</option>
            </select>
            <span asp-validation-for="BatchId" class="text-danger"></span>
        </div>


        <br/>

        <button type="submit" class="btn btn-primary">Submit</button>
    </form>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    <script>
        // Access the value from ViewData
        var currentUserRole = "@ViewData["CurrentUserRole"]";

        // Handle role-specific dropdown visibility
        if (currentUserRole === "Admin") {
            let roleOptionsForAdmin = document.getElementById("roleOptionsForAdmin");
            roleOptionsForAdmin.style.display = "block";

            // Admin role dropdown event listener
            var roleOptionsForAdminSelect = document.getElementById("roleOptionsForAdminSelect");
            roleOptionsForAdminSelect.addEventListener('change', function () {
                handleRoleSelection(roleOptionsForAdminSelect.value);
            });
        } else if (currentUserRole === "Hod") {
            let roleOptionsForHod = document.getElementById("roleOptionsForHod");
            roleOptionsForHod.style.display = "block";

            // Hod role dropdown event listener
            var roleOptionsForHodSelect = document.getElementById("roleOptionsForHodSelect");
            roleOptionsForHodSelect.addEventListener('change', function () {
                handleRoleSelection(roleOptionsForHodSelect.value);
            });
        }

        // Function to handle role-based dynamic field visibility
        function handleRoleSelection(selectedRole) {
            // Hide all role-dependent fields first
            document.getElementById("department").style.display = "none";
            document.getElementById("rollno").style.display = "none";
            document.getElementById("batch").style.display = "none";

            // Display specific fields based on the selected role
            if (selectedRole === "Students") {
                document.getElementById("rollno").style.display = "block";
                document.getElementById("batch").style.display = "block";
                document.getElementById("department").style.display = "block";
            } else if (selectedRole === "Hod" || selectedRole === "Teachers") {
                document.getElementById("department").style.display = "block";
            }
        }
    </script>
}

